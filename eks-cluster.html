<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>EKS Cluster - Cloud Platform Runbooks</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://runbooks.cloud-platform.service.justice.gov.uk/eks-cluster.html">

      <meta name="robots" content="noindex" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="runbooks.cloud-platform.service.justice.gov.uk" />
      <meta name="twitter:image" content="https://runbooks.cloud-platform.service.justice.gov.uk/images/govuk-large.png" />
      <meta name="twitter:title" content="EKS Cluster - Cloud Platform Runbooks" />
      <meta name="twitter:url" content="https://runbooks.cloud-platform.service.justice.gov.uk/eks-cluster.html" />

      <meta property="og:image" content="https://runbooks.cloud-platform.service.justice.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="Cloud Platform Runbooks" />
      <meta property="og:title" content="EKS Cluster" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://runbooks.cloud-platform.service.justice.gov.uk/eks-cluster.html" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          Cloud Platform Runbooks
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide Top Level Navigation">Menu</button>
      <nav>
        <ul id="navigation" class="govuk-header__navigation govuk-header__navigation--end" aria-label="Top Level Navigation">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="mailto:platforms+runbooks@digital.justice.gov.uk?subject=Runbooks+feedback">Feedback / Report a problem</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/">Documentation</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://github.com/ministryofjustice/cloud-platform/tree/main/runbooks">GitHub</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
              <div class="search" data-module="search">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://runbooks.cloud-platform.service.justice.gov.uk"/>
    <label class="govuk-label search__label" for="search" aria-hidden="true">
      Search (via Google)
    </label>
    <input
      type="text"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
  <div id="search-results" class="search-results" aria-hidden="true" role="dialog" aria-labelledby="search-results-title">
    <div class="search-results__inner">
      <button class="search-results__close">Close<span class="search-results__close-label"> search results</span></button>
      <h2 id="search-results-title" class="search-results__title" aria-live="assertive" role="alert">Results</h2>
      <div class="search-results__content"></div>
    </div>
  </div>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading" data-module="collapsible-navigation">
                      <ul>
  <li>
    <a href="/#cloud-platform-runbooks"><span>Cloud Platform Runbooks</span></a>
  </li>
</ul>
<ul>
  <li>
    <a href="/how-we-work.html#how-we-work"><span>How We Work</span></a>
    <ul>
      <li>
        <a href="/how-we-work.html#getting-help"><span>Getting Help</span></a>
      </li>
      <li>
        <a href="/how-we-work.html#the-board-tickets"><span>The Board / Tickets</span></a>
        <ul>
          <li>
            <a href="/how-we-work.html#adding-tickets"><span>Adding tickets</span></a>
          </li>
          <li>
            <a href="/how-we-work.html#making-changes-to-code"><span>Making changes to code</span></a>
          </li>
          <li>
            <a href="/how-we-work.html#reviewing-merging-prs"><span>Reviewing/Merging PRs</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/how-we-work.html#the-hammer-of-justice"><span>The üî® Hammer of Justice</span></a>
        <ul>
          <li>
            <a href="/how-we-work.html#backlog-tickets"><span>Backlog Tickets</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/how-we-work.html#documentation"><span>Documentation</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/how-to-update-gems.html#how-to-update-gem-files-in-technical-documentation"><span>How to update gem files in technical documentation</span></a>
    <ul>
      <li>
        <a href="/how-to-update-gems.html#when-to-update"><span>When to update</span></a>
      </li>
      <li>
        <a href="/how-to-update-gems.html#how-to-update"><span>How to update</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/incident-process.html#incident-process"><span>Incident Process</span></a>
    <ul>
      <li>
        <a href="/incident-process.html#1-confirm-that-the-event-constitutes-an-incident"><span>1. Confirm that the event constitutes an incident</span></a>
      </li>
      <li>
        <a href="/incident-process.html#2-declare-the-incident"><span>2. Declare the incident</span></a>
        <ul>
          <li>
            <a href="/incident-process.html#examples"><span>Examples</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-process.html#3-assign-roles"><span>3. Assign roles</span></a>
        <ul>
          <li>
            <a href="/incident-process.html#3-1-incident-lead"><span>3.1 Incident Lead</span></a>
          </li>
          <li>
            <a href="/incident-process.html#3-2-scribe"><span>3.2 Scribe</span></a>
          </li>
          <li>
            <a href="/incident-process.html#3-3-communications-lead"><span>3.3 Communications Lead</span></a>
          </li>
          <li>
            <a href="/incident-process.html#transferring-roles"><span>Transferring roles</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-process.html#4-fix-the-problem"><span>4. Fix the problem</span></a>
      </li>
      <li>
        <a href="/incident-process.html#5-end-the-incident"><span>5. End the incident</span></a>
      </li>
      <li>
        <a href="/incident-process.html#6-post-incident-procedure"><span>6. Post-incident procedure</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/incident-log.html#incident-log"><span>Incident Log</span></a>
    <ul>
      <li>
        <a href="/incident-log.html#q3-2021-july-september"><span>Q3 2021 (July-September)</span></a>
        <ul>
          <li>
            <a href="/incident-log.html#incident-on-2021-07-12-15-24-all-ingress-resources-using-apps-live-1-domain-names-stop-working"><span>Incident on 2021-07-12 15:24 - All ingress resources using *apps.live-1 domain names stop working</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-log.html#q2-2021-april-june"><span>Q2 2021 (April-June)</span></a>
        <ul>
          <li>
            <a href="/incident-log.html#incident-on-2021-06-09-12-47-all-users-are-unable-to-create-new-ingress-rules-following-bad-modsec-ingress-controller-upgrade"><span>Incident on 2021-06-09 12:47 - All users are unable to create new ingress rules, following bad ModSec Ingress-controller upgrade</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2021-05-10-12-15-apply-pipeline-downtime-due-to-accidental-destroy-of-manager-cluster"><span>Incident on 2021-05-10 12:15 - Apply Pipeline downtime due to accidental destroy of Manager cluster</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-log.html#q1-2021-january-march"><span>Q1 2021 (January - March)</span></a>
        <ul>
          <li>
            <a href="/incident-log.html#no-incidents-declared"><span>No incidents declared</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-log.html#q4-2020-october-december"><span>Q4 2020 (October - December)</span></a>
        <ul>
          <li>
            <a href="/incident-log.html#incident-on-2020-10-06-09-07-intermittent-quot-micro-downtimes-quot-on-various-services-using-dedicated-ingress-controllers"><span>Incident on 2020-10-06 09:07 - Intermittent ‚Äúmicro-downtimes‚Äù on various services using dedicated ingress controllers</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-log.html#q3-2020-july-september"><span>Q3 2020 (July - September)</span></a>
        <ul>
          <li>
            <a href="/incident-log.html#incident-on-2020-09-28-13-10-termination-of-nodes-updating-kops-instance-group"><span>Incident on 2020-09-28 13:10 - Termination of nodes updating kops Instance Group.</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2020-09-21-18-27-some-cloud-platform-components-destroyed"><span>Incident on 2020-09-21 18:27 - Some cloud-platform components destroyed.</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2020-09-07-12-54-all-users-are-unable-to-create-new-ingress-rules"><span>Incident on 2020-09-07 12:54 - All users are unable to create new ingress rules</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2020-08-25-11-26-connectivity-issues-with-eu-west-2a"><span>Incident on 2020-08-25 11:26 - Connectivity issues with eu-west-2a</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2020-08-14-11-01-ingress-controllers-crashlooping"><span>Incident on 2020-08-14 11:01 - Ingress-controllers crashlooping</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2020-08-07-16-39-master-node-provisioning-failure"><span>Incident on 2020-08-07 16:39 - Master node provisioning failure</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-log.html#q2-2020-april-june"><span>Q2 2020 (April - June)</span></a>
        <ul>
          <li>
            <a href="/incident-log.html#incident-on-2020-08-04-17-13"><span>Incident on 2020-08-04 17:13</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2020-04-15-10-58-nginx-tls"><span>Incident on 2020-04-15 10:58 Nginx/TLS</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-log.html#q1-2020-january-march"><span>Q1 2020 (January - March)</span></a>
        <ul>
          <li>
            <a href="/incident-log.html#incident-on-2020-02-25-10-58"><span>Incident on 2020-02-25 10:58</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2020-02-18-14-13-utc"><span>Incident on 2020-02-18 14:13 UTC</span></a>
          </li>
          <li>
            <a href="/incident-log.html#incident-on-2020-02-12-11-45-utc"><span>Incident on 2020-02-12 11:45 UTC</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-log.html#about-this-incident-log"><span>About this incident log</span></a>
      </li>
      <li>
        <a href="/incident-log.html#template"><span>Template</span></a>
        <ul>
          <li>
            <a href="/incident-log.html#incident-on-yyyy-mm-dd-hh-mm-brief-description"><span>Incident on YYYY-MM-DD HH:MM - [Brief description]</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/incident-log.html#impact"><span>Impact:</span></a>
      </li>
      <li>
        <a href="/incident-log.html#context"><span>Context:</span></a>
      </li>
      <li>
        <a href="/incident-log.html#resolution"><span>Resolution:</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/create-cluster.html#create-a-new-cluster"><span>Create a new cluster</span></a>
    <ul>
      <li>
        <a href="/create-cluster.html#create-a-new-cluster-pre-requisites"><span>Pre-requisites</span></a>
      </li>
      <li>
        <a href="/create-cluster.html#environment-variables"><span>Environment Variables</span></a>
      </li>
      <li>
        <a href="/create-cluster.html#run-the-build-script-via-the-tools-image"><span>Run the build script, via the tools image</span></a>
      </li>
      <li>
        <a href="/create-cluster.html#alerts"><span>Alerts</span></a>
        <ul>
          <li>
            <a href="/create-cluster.html#apply-the-changes"><span>Apply the changes</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/create-cluster.html#authenticating"><span>Authenticating</span></a>
      </li>
      <li>
        <a href="/create-cluster.html#docker-authentication"><span>Docker authentication</span></a>
        <ul>
          <li>
            <a href="/create-cluster.html#adding-a-docker-config-file-to-your-cluster"><span>Adding a Docker config file to your cluster</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/changes-in-cloudplatform.html#change-process-in-cloud-platform"><span>Change Process in Cloud Platform</span></a>
    <ul>
      <li>
        <a href="/changes-in-cloudplatform.html#making-changes-to-cloud-plarform-infrastructure"><span>Making Changes to cloud-plarform-infrastructure</span></a>
      </li>
      <li>
        <a href="/changes-in-cloudplatform.html#marking-changes-to-terraform-modules"><span>Marking Changes to terraform modules</span></a>
      </li>
      <li>
        <a href="/changes-in-cloudplatform.html#making-changes-to-helm-charts"><span>Making Changes to Helm Charts</span></a>
      </li>
      <li>
        <a href="/changes-in-cloudplatform.html#making-changes-to-environments-service-teams"><span>Making changes to environments (Service Teams)</span></a>
      </li>
      <li>
        <a href="/changes-in-cloudplatform.html#communications"><span>Communications</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/add-concourse-to-cluster.html#add-concourse-to-a-test-cluster"><span>Add Concourse to a test cluster</span></a>
    <ul>
      <li>
        <a href="/add-concourse-to-cluster.html#add-concourse-to-a-test-cluster-pre-requisites"><span>Pre-requisites</span></a>
      </li>
      <li>
        <a href="/add-concourse-to-cluster.html#process"><span>Process</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/upgrade-cluster.html#upgrade-a-cluster"><span>Upgrade a cluster</span></a>
    <ul>
      <li>
        <a href="/upgrade-cluster.html#planning"><span>Planning</span></a>
      </li>
      <li>
        <a href="/upgrade-cluster.html#upgrade-a-cluster-pre-requisites"><span>Pre-requisites</span></a>
        <ul>
          <li>
            <a href="/upgrade-cluster.html#setup-environment"><span>Setup environment</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#run-the-integration-tests"><span>Run the integration tests</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#sanity-checks"><span>Sanity checks</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#run-a-shell-in-the-tools-image"><span>Run a shell in the tools image</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/upgrade-cluster.html#run-the-upgrade"><span>Run the upgrade</span></a>
        <ul>
          <li>
            <a href="/upgrade-cluster.html#authenticate-to-the-cluster"><span>Authenticate to the cluster</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#update-the-live-cluster-manifest"><span>Update the live cluster manifest</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#push-changes-to-kops-state"><span>Push changes to kops state</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#perform-a-rolling-update"><span>Perform a rolling-update</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#take-stock-of-current-running-worker-nodes"><span>Take stock of current running worker nodes</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#create-new-worker-instance-groups"><span>Create new worker instance groups</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#cordon-old-workers"><span>Cordon old workers</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#scale-the-number-of-ingress-controllers"><span>Scale the number of ingress controllers</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#drain-the-old-worker-nodes"><span>Drain the old worker nodes</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#validate-the-cluster"><span>Validate the cluster</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#run-the-integration-tests-again"><span>Run the integration tests again</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#delete-the-old-instance-groups"><span>Delete the old instance groups</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster.html#scale-the-ingress-controllers-down"><span>Scale the ingress-controllers down</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/upgrade-cluster.html#commit-changes-back-to-main-branch"><span>Commit changes back to main branch</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/upgrade-eks-cluster.html#upgrade-eks-cluster"><span>Upgrade EKS cluster</span></a>
    <ul>
      <li>
        <a href="/upgrade-eks-cluster.html#upgrade-eks-cluster-pre-requisites"><span>Pre-requisites</span></a>
      </li>
      <li>
        <a href="/upgrade-eks-cluster.html#upgrade-steps"><span>Upgrade Steps</span></a>
        <ul>
          <li>
            <a href="/upgrade-eks-cluster.html#upgrade-eks-terraform-module"><span>Upgrade EKS Terraform Module</span></a>
          </li>
          <li>
            <a href="/upgrade-eks-cluster.html#upgrade-control-plane"><span>Upgrade Control Plane</span></a>
          </li>
          <li>
            <a href="/upgrade-eks-cluster.html#upgrade-node-group-s"><span>Upgrade Node Group(s)</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/upgrade-terraform-version.html#upgrade-terraform-version"><span>Upgrade Terraform Version</span></a>
    <ul>
      <li>
        <a href="/upgrade-terraform-version.html#introduction"><span>Introduction</span></a>
      </li>
      <li>
        <a href="/upgrade-terraform-version.html#recommendations"><span>Recommendations</span></a>
      </li>
      <li>
        <a href="/upgrade-terraform-version.html#caveats"><span>Caveats</span></a>
      </li>
      <li>
        <a href="/upgrade-terraform-version.html#how-to-perform-the-upgrade-divide-and-conquer"><span>How to perform the upgrade - divide and conquer</span></a>
        <ul>
          <li>
            <a href="/upgrade-terraform-version.html#before-the-upgrade"><span>Before the upgrade</span></a>
          </li>
          <li>
            <a href="/upgrade-terraform-version.html#environments-state-files"><span>Environments state files</span></a>
          </li>
          <li>
            <a href="/upgrade-terraform-version.html#infrastructure-state-files"><span>Infrastructure state files</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/upgrade-cluster-components.html#upgrade-cluster-components"><span>Upgrade cluster components</span></a>
    <ul>
      <li>
        <a href="/upgrade-cluster-components.html#upgrade-cluster-components-planning"><span>Planning</span></a>
      </li>
      <li>
        <a href="/upgrade-cluster-components.html#testing-the-upgrade-in-a-test-cluster"><span>Testing the upgrade in a test cluster</span></a>
        <ul>
          <li>
            <a href="/upgrade-cluster-components.html#testing-the-upgrade-in-a-test-cluster-setup-environment"><span>Setup environment</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster-components.html#testing-the-upgrade-in-a-test-cluster-run-a-shell-in-the-tools-image"><span>Run a shell in the tools image</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster-components.html#authenticate-to-the-test-cluster"><span>Authenticate to the test cluster</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster-components.html#testing-the-upgrade-in-a-test-cluster-run-the-integration-tests"><span>Run the integration tests</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster-components.html#testing-the-upgrade"><span>Testing the upgrade</span></a>
          </li>
          <li>
            <a href="/upgrade-cluster-components.html#things-to-observe-when-testing-the-upgrade"><span>Things to observe when testing the upgrade</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/delete-cluster.html#delete-a-cluster"><span>Delete a cluster</span></a>
    <ul>
      <li>
        <a href="/delete-cluster.html#delete-the-cluster-using-the-script"><span>Delete the cluster using the script</span></a>
        <ul>
          <li>
            <a href="/delete-cluster.html#first-run-make-tools-shell"><span>First, run make tools-shell</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/delete-cluster.html#delete-the-cluster-using-concourse-fly-commands"><span>Delete the cluster using concourse fly commands</span></a>
      </li>
      <li>
        <a href="/delete-cluster.html#delete-the-cluster-manually"><span>Delete the cluster manually</span></a>
      </li>
      <li>
        <a href="/delete-cluster.html#delete-an-eks-cluster"><span>Delete an EKS cluster</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/add-nodes-to-the-cluster.html#add-nodes-to-the-cluster"><span>Add nodes to the cluster</span></a>
    <ul>
      <li>
        <ul>
          <li>
            <a href="/add-nodes-to-the-cluster.html#requirements"><span>Requirements</span></a>
          </li>
          <li>
            <a href="/add-nodes-to-the-cluster.html#inline-edit"><span>Inline edit</span></a>
          </li>
          <li>
            <a href="/add-nodes-to-the-cluster.html#persisting-the-changes"><span>Persisting the changes</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/add-nodes-to-the-eks-cluster.html#add-nodes-change-the-instance-type-of-the-aws-eks-cluster"><span>Add nodes/change the instance type of the AWS EKS cluster</span></a>
    <ul>
      <li>
        <a href="/add-nodes-to-the-eks-cluster.html#add-nodes-to-the-eks-cluster"><span>Add nodes to the eks cluster</span></a>
        <ul>
          <li>
            <a href="/add-nodes-to-the-eks-cluster.html#add-nodes-to-the-eks-cluster-requirements"><span>Requirements</span></a>
          </li>
          <li>
            <a href="/add-nodes-to-the-eks-cluster.html#cluster-configuration"><span>Cluster configuration:</span></a>
          </li>
          <li>
            <a href="/add-nodes-to-the-eks-cluster.html#issue"><span>Issue</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/add-nodes-to-the-eks-cluster.html#change-the-aws-eks-instance-type-worker-node-machine-type"><span>Change the AWS EKS instance type (worker_node_machine_type)</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/auth0-rotation.html#credentials-rotation-for-auth0-apps"><span>Credentials rotation for auth0 apps</span></a>
    <ul>
      <li>
        <a href="/auth0-rotation.html#preparation"><span>Preparation</span></a>
      </li>
      <li>
        <a href="/auth0-rotation.html#1-taint-resources-terraform"><span>1) Taint resources (terraform)</span></a>
      </li>
      <li>
        <a href="/auth0-rotation.html#2-rolling-update-of-cluster-kops"><span>2) Rolling update of cluster (kops)</span></a>
      </li>
      <li>
        <a href="/auth0-rotation.html#3-apply-changes-within-components-terraform"><span>3) Apply changes within components (terraform)</span></a>
      </li>
      <li>
        <a href="/auth0-rotation.html#4-update-environment-repo"><span>4) Update environment repo</span></a>
      </li>
      <li>
        <a href="/auth0-rotation.html#5-verifiying-changes"><span>5) Verifiying changes</span></a>
      </li>
      <li>
        <a href="/auth0-rotation.html#6-update-pipelines"><span>6) Update pipelines</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/rotate-git-crypt-key.html#git-crypt"><span>Git-crypt</span></a>
    <ul>
      <li>
        <a href="/rotate-git-crypt-key.html#adding-new-user-to-the-keyring"><span>Adding new user to the keyring</span></a>
      </li>
      <li>
        <a href="/rotate-git-crypt-key.html#rotating-the-git-crypt-key"><span>Rotating the git-crypt key</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/custom-domain.html#add-a-custom-domain"><span>Add a custom domain</span></a>
  </li>
</ul>
<ul>
  <li>
    <a href="/add-new-receiver-alert-manager.html#add-a-new-alertmanager-receiver-and-a-slack-webhook"><span>Add a new Alertmanager receiver and a slack webhook</span></a>
    <ul>
      <li>
        <a href="/add-new-receiver-alert-manager.html#add-a-new-alertmanager-receiver-and-a-slack-webhook-pre-requisites"><span>Pre-requisites</span></a>
      </li>
      <li>
        <a href="/add-new-receiver-alert-manager.html#creating-a-new-receiver-set"><span>Creating a new receiver set</span></a>
      </li>
      <li>
        <a href="/add-new-receiver-alert-manager.html#information-alerts"><span>Information Alerts</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/disaster-recovery.html#cloud-platform-disaster-recovery"><span>Cloud Platform Disaster Recovery</span></a>
    <ul>
      <li>
        <a href="/disaster-recovery.html#restore-process"><span>Restore process</span></a>
      </li>
      <li>
        <a href="/disaster-recovery.html#apply-cloud-platform-resources"><span>Apply cloud-platform resources</span></a>
      </li>
      <li>
        <a href="/disaster-recovery.html#cloud-platform-disaster-recovery-create-a-new-cluster"><span>Create a new cluster</span></a>
      </li>
      <li>
        <a href="/disaster-recovery.html#perform-the-restore"><span>Perform the restore</span></a>
        <ul>
          <li>
            <a href="/disaster-recovery.html#perform-the-restore-pre-requisites"><span>Pre-requisites</span></a>
          </li>
          <li>
            <a href="/disaster-recovery.html#restore-the-cluster-using-etcd-manager-ctl-on-your-computer"><span>Restore the cluster using etcd-manager-ctl on your computer.</span></a>
          </li>
          <li>
            <a href="/disaster-recovery.html#restore-process-inside-the-etcd-container-using-etcd-manager-ctl"><span>Restore process inside the etcd container using etcd-manager-ctl.</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/disaster-recovery.html#cleanup"><span>Cleanup</span></a>
      </li>
      <li>
        <a href="/disaster-recovery.html#possible-issues"><span>Possible Issues</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/disaster-recovery-scenarios.html#cloud-platform-disaster-recovery-scenarios"><span>Cloud Platform Disaster Recovery Scenarios</span></a>
    <ul>
      <li>
        <a href="/disaster-recovery-scenarios.html#losing-a-namespace"><span>Losing a Namespace</span></a>
        <ul>
          <li>
            <a href="/disaster-recovery-scenarios.html#losing-a-namespace-impact"><span>Impact</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#possible-cause"><span>Possible Cause</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#losing-a-namespace-restore-process"><span>Restore process</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/disaster-recovery-scenarios.html#losing-a-kubernetes-component-or-object"><span>Losing a Kubernetes Component or Object</span></a>
        <ul>
          <li>
            <a href="/disaster-recovery-scenarios.html#losing-a-kubernetes-component-or-object-impact"><span>Impact</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#losing-a-kubernetes-component-or-object-possible-cause"><span>Possible Cause</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#losing-a-kubernetes-component-or-object-restore-process"><span>Restore process</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/disaster-recovery-scenarios.html#losing-the-whole-cluster"><span>Losing the whole cluster</span></a>
        <ul>
          <li>
            <a href="/disaster-recovery-scenarios.html#losing-the-whole-cluster-impact"><span>Impact</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#losing-the-whole-cluster-possible-cause"><span>Possible Cause</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#how-this-plan-is-tested"><span>How this plan is tested:</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#assumptions"><span>Assumptions</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#losing-the-whole-cluster-restore-process"><span>Restore process</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/disaster-recovery-scenarios.html#deleted-corrupted-the-kops-state"><span>Deleted/corrupted the kops state</span></a>
        <ul>
          <li>
            <a href="/disaster-recovery-scenarios.html#deleted-corrupted-the-kops-state-impact"><span>Impact</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#deleted-corrupted-the-kops-state-possible-cause"><span>Possible Cause</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#restore-process-for-corrupted-kops-state"><span>Restore process for corrupted kops state</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#restore-process-for-deleted-s3-bucket-where-kops-state-is-stored"><span>Restore process for deleted S3 bucket where kops state is stored</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/disaster-recovery-scenarios.html#deleted-terraform-state"><span>Deleted terraform state</span></a>
        <ul>
          <li>
            <a href="/disaster-recovery-scenarios.html#deleted-terraform-state-impact"><span>Impact</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#deleted-terraform-state-possible-cause"><span>Possible Cause</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#deleted-terraform-state-restore-process"><span>Restore process</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#recovering-more-complex-scenarios"><span>Recovering more complex scenarios</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/disaster-recovery-scenarios.html#lost-or-corrupt-etcd-volume"><span>Lost or corrupt etcd volume</span></a>
        <ul>
          <li>
            <a href="/disaster-recovery-scenarios.html#lost-or-corrupt-etcd-volume-impact"><span>Impact</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#lost-or-corrupt-etcd-volume-possible-cause"><span>Possible Cause</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#lost-or-corrupt-etcd-volume-restore-process"><span>Restore process</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/disaster-recovery-scenarios.html#overwriting-kops-cluster-39-s-components-with-eks-components"><span>Overwriting KOPS cluster‚Äôs components with EKS components</span></a>
        <ul>
          <li>
            <a href="/disaster-recovery-scenarios.html#overwriting-kops-cluster-39-s-components-with-eks-components-impact"><span>Impact</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#overwriting-kops-cluster-39-s-components-with-eks-components-possible-cause"><span>Possible Cause</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#overwriting-kops-cluster-39-s-components-with-eks-components-restore-process"><span>Restore process</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#reproducing-incident-steps"><span>Reproducing Incident Steps</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#velero-backup"><span>Velero Backup</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#apply-the-eks-components-to-the-kops-cluster"><span>Apply the EKS components to the KOPS cluster</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#observations-of-incident"><span>Observations of Incident</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#destroy-the-eks-components"><span>Destroy the EKS components</span></a>
          </li>
          <li>
            <a href="/disaster-recovery-scenarios.html#re-apply-the-kops-components"><span>Re-apply the KOPS components</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/rotate-user-aws-credentials.html#rotate-user-aws-credentials"><span>Rotate User AWS Credentials</span></a>
    <ul>
      <li>
        <ul>
          <li>
          </li>
        </ul>
      </li>
      <li>
        <a href="/rotate-user-aws-credentials.html#set-pingdom-environment-variables-optional"><span>Set pingdom environment variables(Optional)</span></a>
      </li>
      <li>
        <a href="/rotate-user-aws-credentials.html#target-the-live-1-cluster"><span>Target the live-1 cluster</span></a>
      </li>
      <li>
        <a href="/rotate-user-aws-credentials.html#set-cluster-related-environment-variables"><span>Set cluster related environment variables</span></a>
      </li>
      <li>
        <a href="/rotate-user-aws-credentials.html#set-the-namespace-name"><span>Set the namespace name</span></a>
      </li>
      <li>
        <a href="/rotate-user-aws-credentials.html#terraform-init"><span>Terraform Init</span></a>
      </li>
      <li>
        <a href="/rotate-user-aws-credentials.html#terraform-plan-apply"><span>Terraform Plan/Apply</span></a>
        <ul>
          <li>
            <a href="/rotate-user-aws-credentials.html#2-identify-the-compromised-terraform-object"><span>2. Identify the compromised terraform object</span></a>
          </li>
          <li>
            <a href="/rotate-user-aws-credentials.html#3-destroy-the-compromised-key"><span>3. Destroy the compromised key</span></a>
          </li>
          <li>
            <a href="/rotate-user-aws-credentials.html#4-let-terraform-create-a-new-key"><span>4. Let terraform create a new key</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/aws-leaked-credentials.html#aws-compromised-credentials"><span>AWS Compromised Credentials</span></a>
    <ul>
      <li>
        <a href="/aws-leaked-credentials.html#steps-for-a-leaked-credentials"><span>Steps for a leaked credentials</span></a>
      </li>
      <li>
        <a href="/aws-leaked-credentials.html#getting-new-credentials"><span>Getting new credentials</span></a>
      </li>
      <li>
        <a href="/aws-leaked-credentials.html#audit-the-compromised-credentials"><span>Audit the compromised credentials</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/aws-create-user.html#aws-console-access"><span>AWS Console Access</span></a>
    <ul>
      <li>
        <a href="/aws-create-user.html#steps-to-create-delete-users"><span>Steps to create/delete users</span></a>
      </li>
      <li>
        <a href="/aws-create-user.html#activating-mfa-for-new-users"><span>Activating MFA for new users</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/public-s3-bucket.html#make-an-s3-bucket-public"><span>Make an S3 bucket public</span></a>
  </li>
</ul>
<ul>
  <li>
    <a href="/delete-prometheus-metrics.html#delete-prometheus-metrics"><span>Delete Prometheus Metrics</span></a>
    <ul>
      <li>
        <a href="/delete-prometheus-metrics.html#1-identify-the-metrics-you-want-to-delete"><span>1.  Identify the metrics you want to delete</span></a>
      </li>
      <li>
        <a href="/delete-prometheus-metrics.html#2-enable-the-admin-interface-in-prometheus"><span>2. Enable the admin interface in Prometheus</span></a>
      </li>
      <li>
        <a href="/delete-prometheus-metrics.html#3-launch-a-port-forward-pod"><span>3. Launch a port-forward pod</span></a>
      </li>
      <li>
        <a href="/delete-prometheus-metrics.html#4-forward-local-traffic-to-prometheus"><span>4. Forward local traffic to Prometheus</span></a>
      </li>
      <li>
        <a href="/delete-prometheus-metrics.html#5-use-curl-in-another-terminal-to-hit-the-api-endpoint"><span>5. Use curl (in another terminal) to hit the API endpoint</span></a>
      </li>
      <li>
        <a href="/delete-prometheus-metrics.html#6-use-this-script-to-delete-multiple-metrics"><span>6. Use this script to delete multiple metrics</span></a>
      </li>
      <li>
        <a href="/delete-prometheus-metrics.html#7-clean-up"><span>7. Clean up</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/manually-apply-namespace.html#manually-plan-apply-namespace-resources"><span>Manually Plan/Apply Namespace Resources</span></a>
    <ul>
      <li>
        <a href="/manually-apply-namespace.html#start-in-the-appropriate-branch-of-the-environments-repo"><span>Start in the appropriate branch of the environments repo</span></a>
      </li>
      <li>
        <a href="/manually-apply-namespace.html#manually-plan-apply-namespace-resources-set-pingdom-environment-variables-optional"><span>Set pingdom environment variables(Optional)</span></a>
      </li>
      <li>
        <a href="/manually-apply-namespace.html#manually-plan-apply-namespace-resources-target-the-live-1-cluster"><span>Target the live-1 cluster</span></a>
      </li>
      <li>
        <a href="/manually-apply-namespace.html#set-some-environment-variables"><span>Set some environment variables</span></a>
      </li>
      <li>
        <a href="/manually-apply-namespace.html#manually-plan-apply-namespace-resources-set-the-namespace-name"><span>Set the namespace name</span></a>
      </li>
      <li>
        <a href="/manually-apply-namespace.html#manually-plan-apply-namespace-resources-terraform-init"><span>Terraform Init</span></a>
      </li>
      <li>
        <a href="/manually-apply-namespace.html#manually-plan-apply-namespace-resources-terraform-plan-apply"><span>Terraform Plan/Apply</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/remove-data-from-elasticsearch.html#remove-data-from-elasticsearch"><span>Remove data from Elasticsearch</span></a>
    <ul>
      <li>
        <a href="/remove-data-from-elasticsearch.html#stop-the-breach-first"><span>Stop the breach first</span></a>
      </li>
      <li>
        <a href="/remove-data-from-elasticsearch.html#things-to-know"><span>Things to know</span></a>
      </li>
      <li>
        <a href="/remove-data-from-elasticsearch.html#build-your-query"><span>Build your query</span></a>
      </li>
      <li>
        <a href="/remove-data-from-elasticsearch.html#delete-by-query"><span>Delete by query</span></a>
      </li>
      <li>
        <a href="/remove-data-from-elasticsearch.html#removing-specific-logs-filtered-by-phrase"><span>Removing specific logs filtered by phrase</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/export-elasticsearch-to-csv.html#export-data-from-elasticsearch-into-a-csv-file"><span>Export data from Elasticsearch into a CSV file</span></a>
    <ul>
      <li>
        <a href="/export-elasticsearch-to-csv.html#workaround"><span>Workaround</span></a>
        <ul>
          <li>
            <a href="/export-elasticsearch-to-csv.html#install-es2csv"><span>Install es2csv</span></a>
          </li>
          <li>
            <a href="/export-elasticsearch-to-csv.html#usage"><span>Usage</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/manually-delete-namespace-resources.html#manually-delete-namespace-resources"><span>Manually Delete Namespace Resources</span></a>
  </li>
</ul>
<ul>
  <li>
    <a href="/delete-state-lock.html#delete-terraform-state-lock"><span>Delete terraform state lock</span></a>
    <ul>
      <li>
        <a href="/delete-state-lock.html#command-line-method"><span>Command-line method</span></a>
      </li>
      <li>
        <a href="/delete-state-lock.html#aws-console-method"><span>AWS Console method</span></a>
      </li>
      <li>
        <a href="/delete-state-lock.html#terraform-command"><span>Terraform command</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/error-refreshing-state.html#terraform-state-lock-error-refreshing-state"><span>Terraform state lock - Error refreshing state</span></a>
  </li>
</ul>
<ul>
  <li>
    <a href="/divergence-error.html#how-to-investigate-divergence-errors"><span>How to Investigate Divergence Errors</span></a>
    <ul>
      <li>
        <a href="/divergence-error.html#reproduce-the-plan"><span>Reproduce the plan</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/replacing-failed-master-node.html#recover-from-an-etcd-failure"><span>Recover from an etcd failure</span></a>
    <ul>
      <li>
        <a href="/replacing-failed-master-node.html#recover-from-an-etcd-failure-pre-requisites"><span>Pre-requisites</span></a>
      </li>
      <li>
        <a href="/replacing-failed-master-node.html#identify-the-failed-master-node"><span>Identify the failed master node</span></a>
      </li>
      <li>
        <a href="/replacing-failed-master-node.html#remove-the-unhealthy-etcd-member"><span>Remove the unhealthy etcd member.</span></a>
      </li>
      <li>
        <a href="/replacing-failed-master-node.html#replacing-the-failed-master-via-kops"><span>Replacing the failed master via kops</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/recycle-node.html#recycle-node"><span>Recycle-node</span></a>
    <ul>
      <li>
        <a href="/recycle-node.html#guidance-for-the-cloud-platform-team-when-the-recycle-node-pipeline-job-fails"><span>Guidance for the Cloud Platform team, when the recycle-node pipeline job fails:</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/eks-cluster.html#provisioning-eks-clusters"><span>Provisioning EKS clusters</span></a>
    <ul>
      <li>
        <a href="/eks-cluster.html#pre-requisites"><span>Pre-requisites</span></a>
      </li>
      <li>
        <a href="/eks-cluster.html#provisioning"><span>Provisioning</span></a>
        <ul>
          <li>
            <a href="/eks-cluster.html#1-vpc"><span>1. VPC</span></a>
          </li>
          <li>
            <a href="/eks-cluster.html#2-creating-eks-cluster"><span>2. Creating EKS cluster</span></a>
          </li>
          <li>
            <a href="/eks-cluster.html#3-deploy-components"><span>3. Deploy components</span></a>
          </li>
          <li>
            <a href="/eks-cluster.html#4-delete-the-eks-cluster"><span>4. Delete the EKS cluster</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/post-migration.html#post-migration-cleanup"><span>Post migration cleanup</span></a>
    <ul>
      <li>
        <a href="/post-migration.html#table-of-contents"><span>Table of contents</span></a>
      </li>
      <li>
        <a href="/post-migration.html#when-to-use-this-document"><span>When to use this document?</span></a>
      </li>
      <li>
        <a href="/post-migration.html#0-pre-requisites"><span>0. Pre-requisites</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
      <li>
        <a href="/post-migration.html#1-turn-off-template-deploy-monitoring-and-alerting"><span>1. Turn off Template Deploy monitoring and alerting</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
      <li>
        <a href="/post-migration.html#2-archive-the-deployment-repository"><span>2. Archive the deployment repository</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
      <li>
        <a href="/post-migration.html#3-backup-old-template-deploy-data"><span>3. Backup old Template Deploy data</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
      <li>
        <a href="/post-migration.html#4-delete-the-old-cloudformation-stack"><span>4. Delete the old CloudFormation stack</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
      <li>
        <a href="/post-migration.html#5-ensure-removal-of-resources"><span>5. Ensure removal of resources</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
      <li>
        <a href="/post-migration.html#6-ensure-live-service-is-still-functioning"><span>6. Ensure live service is still functioning!</span></a>
        <ul>
          <li>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/expand.html#expanding-persistent-volumes-created-using-statefulsets"><span>Expanding Persistent Volumes created using StatefulSets</span></a>
  </li>
</ul>
<ul>
  <li>
    <a href="/velero.html#velero-cluster-backups-and-disaster-recovery"><span>Velero - Cluster backups and disaster recovery</span></a>
    <ul>
      <li>
        <ul>
          <li>
          </li>
        </ul>
      </li>
      <li>
        <a href="/velero.html#backups"><span>Backups</span></a>
        <ul>
          <li>
            <a href="/velero.html#why"><span>Why?</span></a>
          </li>
          <li>
            <a href="/velero.html#what"><span>What?</span></a>
          </li>
          <li>
            <a href="/velero.html#how"><span>How?</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/sonarqube-scan.html#sonarqube-code-quality-and-security-scanning"><span>Sonarqube - Code quality and security scanning</span></a>
    <ul>
      <li>
        <a href="/sonarqube-scan.html#sonarqube-scanning"><span>Sonarqube scanning</span></a>
        <ul>
          <li>
            <a href="/sonarqube-scan.html#sonarqube-scan-all-repositories"><span>Sonarqube scan all repositories</span></a>
          </li>
          <li>
            <a href="/sonarqube-scan.html#sonarqube-github-action"><span>Sonarqube Github Action</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/running-kops-update-rollingupdate.html#running-kops-update-and-rollingupdate"><span>Running Kops Update and Rollingupdate</span></a>
    <ul>
      <li>
        <a href="/running-kops-update-rollingupdate.html#using-kops-to-change-the-cluster"><span>Using kops to change the cluster</span></a>
      </li>
      <li>
        <a href="/running-kops-update-rollingupdate.html#running-kops-update-and-rollingupdate-pre-requisites"><span>Pre-requisites</span></a>
      </li>
      <li>
        <a href="/running-kops-update-rollingupdate.html#updating-the-kops-state"><span>Updating the kops state</span></a>
        <ul>
          <li>
            <a href="/running-kops-update-rollingupdate.html#generating-an-updated-kops-config-file"><span>Generating an updated kops config file</span></a>
          </li>
          <li>
            <a href="/running-kops-update-rollingupdate.html#applying-local-changes-to-the-kops-state-store"><span>Applying local changes to the kops state store</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/running-kops-update-rollingupdate.html#running-kops-update"><span>Running Kops update</span></a>
      </li>
      <li>
        <a href="/running-kops-update-rollingupdate.html#running-kops-rolling-update"><span>Running Kops rolling-update</span></a>
      </li>
      <li>
        <a href="/running-kops-update-rollingupdate.html#possible-errors"><span>Possible Errors</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/helm-repository.html#cloud-platform-helm-chart-repository"><span>Cloud Platform helm chart repository</span></a>
    <ul>
      <li>
        <a href="/helm-repository.html#performing-crud-on-cloud-platform-helm-repository"><span>Performing CRUD on Cloud Platform Helm repository</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/get-audit-log-from-modsec.html#get-an-audit-log-from-modsec"><span>Get an audit log from modsec</span></a>
    <ul>
      <li>
        <a href="/get-audit-log-from-modsec.html#how-do-i-check-the-audit-log"><span>How do I check the audit log</span></a>
      </li>
      <li>
        <a href="/get-audit-log-from-modsec.html#exec-into-the-pod"><span>Exec into the pod</span></a>
      </li>
      <li>
        <a href="/get-audit-log-from-modsec.html#perform-a-search-for-the-unique-id-obtained-from-the-kibana-entry"><span>Perform a search for the unique-id (obtained from the Kibana entry)</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/auth-keys.html#how-to-add-authorized-keys"><span>How to add authorized keys</span></a>
  </li>
</ul>
<ul>
  <li>
    <a href="/access-eks-cluster.html#access-eks-cluster"><span>Access EKS cluster</span></a>
    <ul>
      <li>
        <a href="/access-eks-cluster.html#access-eks-cluster-pre-requisites"><span>Pre-requisites</span></a>
        <ul>
          <li>
            <a href="/access-eks-cluster.html#create-kubeconfig-using-aws-command"><span>Create kubeconfig using aws command</span></a>
          </li>
          <li>
            <a href="/access-eks-cluster.html#create-kubeconfig-manually-using-a-template"><span>Create kubeconfig manually using a template</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/destroy-concourse-build-data.html#destroy-concourse-build-data"><span>Destroy Concourse Build Data</span></a>
    <ul>
      <li>
        <a href="/destroy-concourse-build-data.html#overview"><span>Overview</span></a>
      </li>
      <li>
        <a href="/destroy-concourse-build-data.html#steps-to-remove-the-build-data"><span>Steps to remove the build data</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/custom-default-backend.html#custom-default-backend"><span>Custom default-backend</span></a>
    <ul>
      <li>
        <ul>
          <li>
            <a href="/custom-default-backend.html#background"><span>Background</span></a>
          </li>
          <li>
            <a href="/custom-default-backend.html#use-platform-level-error-page"><span>Use platform-level error page</span></a>
          </li>
          <li>
            <a href="/custom-default-backend.html#not-use-platform-level-error-page"><span>Not use platform-level error page</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/add-new-opa-policy.html#open-policy-agent-policies"><span>Open Policy Agent policies</span></a>
    <ul>
      <li>
        <a href="/add-new-opa-policy.html#adding-a-policy"><span>Adding a policy</span></a>
      </li>
      <li>
        <a href="/add-new-opa-policy.html#writing-tests"><span>Writing tests</span></a>
      </li>
      <li>
        <a href="/add-new-opa-policy.html#references"><span>References</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/cloud-platform-to-tgw.html#adding-a-route-to-connect-to-a-tgw"><span>Adding a route to connect to a TGW</span></a>
    <ul>
      <li>
        <a href="/cloud-platform-to-tgw.html#quick-introduction"><span>Quick introduction</span></a>
      </li>
      <li>
        <a href="/cloud-platform-to-tgw.html#transit-gateway"><span>Transit Gateway</span></a>
      </li>
      <li>
        <a href="/cloud-platform-to-tgw.html#making-the-change"><span>Making the change</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/joiners-guide.html#onboarding-into-the-cloud-platform-team"><span>Onboarding into the Cloud Platform Team</span></a>
    <ul>
      <li>
        <a href="/joiners-guide.html#people-team"><span>People Team</span></a>
      </li>
      <li>
        <a href="/joiners-guide.html#service-desk"><span>Service Desk</span></a>
      </li>
      <li>
        <a href="/joiners-guide.html#sit-down-with-dm"><span>Sit down with DM</span></a>
      </li>
      <li>
        <a href="/joiners-guide.html#cloud-platform-team"><span>Cloud Platform team</span></a>
      </li>
      <li>
        <a href="/joiners-guide.html#access"><span>ACCESS</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/leavers-guide.html#leavers-guide"><span>Leavers Guide</span></a>
    <ul>
      <li>
        <a href="/leavers-guide.html#revoking-access"><span>Revoking Access</span></a>
        <ul>
          <li>
            <a href="/leavers-guide.html#digital-services"><span>Digital Services</span></a>
          </li>
          <li>
            <a href="/leavers-guide.html#aws-accounts"><span>AWS Accounts</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/scheduled-pr-reminders.html#scheduled-pr-reminders"><span>Scheduled PR Reminders</span></a>
    <ul>
      <li>
        <ul>
          <li>
            <a href="/scheduled-pr-reminders.html#steps-required-for-new-repositories"><span>Steps required for new repositories</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/grafana-dashboards.html#grafana-dashboards"><span>Grafana Dashboards</span></a>
    <ul>
      <li>
        <a href="/grafana-dashboards.html#kubernetes-number-of-pods-per-node"><span>Kubernetes Number of Pods per Node</span></a>
        <ul>
          <li>
            <a href="/grafana-dashboards.html#dashboard-layout"><span>Dashboard Layout</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/on-call.html#going-on-call"><span>Going on call</span></a>
    <ul>
      <li>
        <a href="/on-call.html#what-s-expected"><span>What‚Äôs expected?</span></a>
        <ul>
          <li>
            <a href="/on-call.html#expected"><span>Expected:</span></a>
          </li>
          <li>
            <a href="/on-call.html#not-expected"><span>Not Expected:</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/on-call.html#where-do-i-start"><span>Where do I start?</span></a>
      </li>
      <li>
        <a href="/on-call.html#what-do-i-get-for-being-on-call"><span>What do I get for being on call?</span></a>
      </li>
      <li>
        <a href="/on-call.html#civil-servants"><span>Civil servants</span></a>
      </li>
      <li>
        <a href="/on-call.html#contractors"><span>Contractors</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/cloud-platform-communications-plan.html#cloud-platform-communications-plan"><span>Cloud Platform Communications Plan</span></a>
    <ul>
      <li>
        <a href="/cloud-platform-communications-plan.html#the-plan"><span>The Plan</span></a>
      </li>
      <li>
        <a href="/cloud-platform-communications-plan.html#tips-on-format-of-communications"><span>Tips on format of communications</span></a>
        <ul>
          <li>
            <a href="/cloud-platform-communications-plan.html#tips-on-format-of-communications-examples"><span>Examples</span></a>
          </li>
          <li>
            <a href="/cloud-platform-communications-plan.html#things-to-include-in-incident-communications"><span>Things to include in incident communications</span></a>
          </li>
          <li>
            <a href="/cloud-platform-communications-plan.html#example"><span>Example</span></a>
          </li>
          <li>
            <a href="/cloud-platform-communications-plan.html#things-to-include-in-upgrade-communications"><span>Things to include in upgrade communications</span></a>
          </li>
          <li>
            <a href="/cloud-platform-communications-plan.html#tips-on-format-of-communications-example"><span>Example</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="/cloud-platform-communications-plan.html#sharing-information-with-the-wider-ministry-of-justice-and-the-public"><span>Sharing information with the wider Ministry of Justice and the Public</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/tips-and-tricks.html#tips-and-tricks"><span>Tips and Tricks</span></a>
    <ul>
      <li>
        <a href="/tips-and-tricks.html#delete-an-rds-database-snapshot"><span>Delete an RDS database snapshot</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#check-the-expiration-date-of-the-ssl-certificate-for-a-live-domain"><span>Check the expiration date of the SSL certificate for a live domain</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#run-etcdctl-on-a-master-node"><span>Run etcdctl on a master node</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#delete-a-quot-stuck-quot-resource"><span>Delete a ‚Äústuck‚Äù resource</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#filter-namespaces-by-specific-label-or-annotation"><span>Filter namespaces by specific label or annotation</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#find-all-pods-running-on-a-specific-worker-node"><span>Find all pods running on a specific worker node</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#count-pods-running-on-all-nodes"><span>Count pods running on all nodes</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#install-tmux-and-docker-on-the-live-1-bastion-host"><span>Install tmux and docker on the live-1 bastion host</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#output-all-records-from-route53-as-a-csv-file"><span>Output all records from Route53 as a CSV file</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#add-more-rss-feeds-to-cloud-platform-rss-channel"><span>Add more RSS feeds to #cloud-platform-rss channel</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#find-files-which-don-39-t-contain-a-particular-string"><span>Find files which don‚Äôt contain a particular string</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#get-aws-ec2-instance-information-for-a-node"><span>Get AWS EC2 instance information for a node</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#create-a-one-off-job-to-repeat-a-cronjob"><span>Create a one-off job to repeat a cronjob</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#hijack-a-concourse-job-container"><span>Hijack a concourse job container</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#help-when-manually-deleting-aws-resources"><span>Help when manually deleting AWS resources</span></a>
      </li>
      <li>
        <a href="/tips-and-tricks.html#find-out-why-your-namespace-isn-39-t-deleting"><span>Find out why your namespace isn‚Äôt deleting</span></a>
      </li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <a href="/add-a-new-runbook.html#add-a-new-runbook"><span>Add a new runbook</span></a>
    <ul>
      <li>
        <ul>
          <li>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              <h1 id="provisioning-eks-clusters">Provisioning EKS clusters</h1><p>For now EKS is only used for the manager cluster, it mainly holds Cloud Platform concourse CI. We are working on migrating our live cluster to EKS.</p>
<p><strong>IMPORTANT:</strong> All cluster&rsquo;s names <strong>must be globally unique</strong> (EKS or kOps). Each one creates a unique Route53 hostzone which is unique to the name</p>
<p>You can create a new EKS test cluster using the <a href="https://concourse.cloud-platform.service.justice.gov.uk/teams/main/pipelines/build-test-cluster/">cluster build pipeline</a>.</p>
<p>Alternatively, using the <code>create-cluster</code> script.</p>
<p>Execute the script, by giving the <code>-k eks</code> or <code>--kind eks</code> option and the desired name of your new cluster. e.g.:</p>
<div class="highlight"><pre class="highlight shell" tabindex="0"><code>./create-cluster.rb <span class="nt">--name</span> mogaal-eks <span class="nt">--kind</span> eks
</code></pre></div><p>Check the <a href="https://runbooks.cloud-platform.service.justice.gov.uk/create-cluster.html#create-a-new-cluster">create a cluster</a> runbook for pre-requisites and environment variables to run the script.</p>
<p>Alternatively, if you need more control over the test cluster parameters, or you just prefer to do it manually, the rest of this document describes the process.</p>
<h2 id="pre-requisites">Pre-requisites</h2>
<ul>
<li>Make sure you have access to Cloud Platform AWS account</li>
<li>Set your environment variables (you might also want to include <code>AWS_*</code> envs):</li>
</ul>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>    export KOPS_STATE_STORE=s3://cloud-platform-kops-state
    export AWS_PROFILE=moj-cp
</code></pre></div><h2 id="provisioning">Provisioning</h2><h3 id="1-vpc">1. VPC</h3><p>We need to create a VPC to deploy the cluster, VPCs are deployed using terraform code under <a href="https://github.com/ministryofjustice/cloud-platform-infrastructure/tree/main/terraform/aws-accounts/cloud-platform-aws/vpc">cloud-platform-infrastructure/terraform/aws-accounts/cloud-platform-aws/vpc</a> folder:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>cd cloud-platform-infrastructure/terraform/aws-acounts/cloud-platform-aws/vpc
terraform init
terraform workspace new &lt;WorkspaceName&gt;
terraform apply
</code></pre></div><p>You should be able to see your new VPC (called <code>WorkspaceName</code>) inside the AWS Console. Check it before jumping to the next step.</p>
<p><strong>NOTE</strong>: For conventions purposes please call all terraform workspaces the same.</p>
<h3 id="2-creating-eks-cluster">2. Creating EKS cluster</h3><p>Now it&rsquo;s time to provision the cluster itself, we change directory to <a href="https://github.com/ministryofjustice/cloud-platform-infrastructure/tree/main/terraform/aws-accounts/cloud-platform-aws/vpc/eks">terraform/aws-accounts/cloud-platform-aws/vpc/eks</a> and follow very similar terraform workflow:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>terraform init
terraform workspace new &lt;WorkspaceName&gt;
terraform apply -var="vpc_name=$VPC_NAME"
</code></pre></div><p><code>vpc_name</code> must be set, it&rsquo;s the only required variable. It can also be used variables like <code>cluster_node_count</code> and <code>worker_node_machine_type</code> to set up different node groups parameters</p>
<p>Once terraform finishes you should be able to generate your kubeadmin file (used by <em>kubectl</em> to establish a connection to the cluster) using aws-cli in the following way:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>aws eks --region eu-west-2 update-kubeconfig --name mogaal-eks
</code></pre></div><p><strong>NOTE</strong>: Replace &ldquo;mogaal-eks&rdquo; with the cluster name (workspace name)</p>
<p>Final check for this step consists in cluster connection</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>$ kubectl cluster-info
Kubernetes master is running at https://B04C5FC7828A0515457E141A9610815D.sk1.eu-west-2.eks.amazonaws.com
CoreDNS is running at https://B04C5FC7828A0515457E141A9610815D.sk1.eu-west-2.eks.amazonaws.com/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.

</code></pre></div><h3 id="3-deploy-components">3. Deploy components</h3><p>Components installation is the last step, for that we need to have the <code>KUBECONFIG</code> variable exported and make sure you have access to the cluster. To deploy components we go to <a href="https://github.com/ministryofjustice/cloud-platform-infrastructure/tree/main/terraform/aws-accounts/cloud-platform-aws/vpc/eks/components">terraform/aws-accounts/cloud-platform-aws/vpc/eks/components</a> and follow exactly the same terraform workflow:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>terraform init
terraform workspace new &lt;WorkspaceName&gt;
terraform apply
</code></pre></div><h3 id="4-delete-the-eks-cluster">4. Delete the EKS cluster</h3><h4 id="delete-the-eks-cluster-using-the-script">Delete the EKS cluster using the script</h4><p>There is a <a href="https://github.com/ministryofjustice/cloud-platform-infrastructure/blob/main/destroy-cluster.rb">destroy-cluster.rb</a> script which you can use to delete your cluster.</p>
<p>Read the script before using it. Deleting a cluster is something you should be very cautious about, and ensure you know exactly what you&rsquo;re doing.</p>
<p>The script is entirely non-interactive, and will not prompt you to confirm anything. It just destroys things.</p>
<p>First, run <code>make tools-shell</code></p>

<blockquote>
<p>The delete cluster script must <em>always</em> be run in a container. This ensures that the environment of the script is fully controlled, and you don&rsquo;t run into problems such as the kubernetes context being changed in another window, or extra environment variables causing unwanted effects.</p>
</blockquote>
<p>Then invoke the script like this:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>./destroy-cluster.rb --name [short cluster name] --kind eks --yes
</code></pre></div><p>Run without <code>--yes</code> to do a dry run, and see what commands would be executed.</p>
<p>You can get more information using:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>./destroy-cluster.rb --help
</code></pre></div><p>If any steps fail:</p>

<ul>
<li>Fix the underlying problem</li>
<li>Edit the script to comment out any sections of the <code>ClusterDeleter.run</code> function which you no longer need to run</li>
<li>Re-run the script</li>
</ul>
<h4 id="delete-the-eks-cluster-manually">Delete the EKS cluster manually</h4><p>Follow these steps, to delete the EKS cluster.</p>
<p>First, set the kubectl context for the EKS cluster you are deleting. The easiest way to do this is with aws command:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>$ export KUBECONFIG=~/.kube/config
$ export cluster=&lt;cluster-name&gt;
$ aws eks --region eu-west-2 update-kubeconfig --name ${cluster}
</code></pre></div><p>You should see this output:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>Added new context arn:aws:eks:eu-west-2:754256621582:cluster/&lt;cluster-name&gt; to .kube/config

</code></pre></div><p>Then, from the root of a checkout of the <code>cloud-platform-infrastructure</code> repository, run 
these commands to destroy all cluster components, and delete the terraform workspace:</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>$ cd terraform/aws-accounts/cloud-platform-aws/vpc/eks/components
$ terraform init
$ terraform workspace select ${cluster}
$ terraform destroy
</code></pre></div>
<blockquote>
<p>The destroy process often gets stuck on prometheus operator. If that happens, running this in a separate window usually works:
<code>
kubectl -n monitoring delete job prometheus-operator-operator-cleanup
</code></p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>$ terraform workspace select default
$ terraform workspace delete ${cluster}
</code></pre></div><p>Change directories and perform the following to destroy the EKS cluster, and delete the terraform workspace.</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>$ cd .. # working dir is now `eks`
$ terraform init
$ terraform workspace select ${cluster}
$ terraform destroy
$ terraform workspace select default
$ terraform workspace delete ${cluster}
</code></pre></div><p>Change directories and perform the following to destroy the cluster VPC, and delete the terraform workspace.</p>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>$ cd .. # working dir is now `vpc`
$ terraform init
$ terraform workspace select ${cluster}
$ terraform destroy
$ terraform workspace select default
$ terraform workspace delete ${cluster}
</code></pre></div>

              <div data-module='page-expiry' data-last-reviewed-on="2021-10-26">
    <div class='page-expiry--not-expired'>
      This page was last reviewed on 26 July 2021.

        It needs to be reviewed again on 26 October 2021
        by the page owner <a href="https://mojdt.slack.com/messages/cloud-platform">#cloud-platform</a>
        .
    </div>

    <div class='page-expiry--expired'>
      This page was set to be reviewed before 26 October 2021
       by the page owner <a href="https://mojdt.slack.com/messages/cloud-platform">#cloud-platform</a>.
      This might mean the content is out of date.
    </div>
  </div>

          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/ministryofjustice/cloud-platform/blob/main/runbooks/source/eks-cluster.html.md.erb">View source</a></li>
                <li><a href="https://github.com/ministryofjustice/cloud-platform/issues/new?labels=bug&amp;title=Re:%20'EKS%20Cluster'&amp;body=Problem%20with%20'EKS%20Cluster'%20(https://runbooks.cloud-platform.service.justice.gov.uk/eks-cluster.html)">Report problem</a></li>
                <li><a href="https://github.com/ministryofjustice/cloud-platform">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">


      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >¬© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/application.js"></script>
  </body>
</html>
